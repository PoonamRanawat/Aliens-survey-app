!function e(t,n,r){function a(s,i){if(!n[s]){if(!t[s]){var c="function"==typeof require&&require;if(!i&&c)return c(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return a(n||e)},l,l.exports,e,t,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)a(r[s]);return a}({1:[function(e,t,n){t.exports=["$rootScope","$state","$auth",function(e,t,n){e.isOpen=!1,e.pinPages={},e.tosterConfig={"time-out":1e4,"position-class":"toast-top-center","close-button":!0},e.$on("$locationChangeSuccess",function(){n.isAuthenticated()||t.go("main.login")}),t.go("main.login")}]},{}],2:[function(e,t,n){t.exports=["$stateProvider","$httpProvider","appConstant","$authProvider","$locationProvider",function(e,t,n,r,a){a.hashPrefix(""),r.httpInterceptor=function(){return!0},r.tokenHeader="Authorization",r.tokenType="",t.interceptors.push("authInterceptor"),e.state("main",{abstract:!0,templateUrl:"./app/components/main/main-view.html",controller:"mainCtrl"}).state("main.login",{url:"/login",templateUrl:"./app/components/login/login.html",controller:"loginCtrl"}).state("admin",{abstract:!0,templateUrl:"./app/components/admin/main.html",controller:"adminCtrl"}).state("admin.users",{url:"/admin/users",templateUrl:"./app/components/admin/users/users.html",controller:"usersCtrl"})}]},{}],3:[function(e,t,n){"use strict";t.exports=["$scope","authenticationSvc","$auth","$state",function(e,t,n,r){e.logout=function(){t.logout().then(function(e){if(console.log(e),200==e.status_code&&e.success)return n.removeToken(),localStorage.removeItem("expiry_time"),localStorage.removeItem("expiry_time"),localStorage.removeItem("loggedInPersonName"),localStorage.removeItem("userData"),r.go("main.login"),e;e.success||"Unathenticated"!=e.message||r.go("main.login")}).catch(function(e){console.log(e)})}}]},{}],4:[function(e,t,n){t.exports=angular.module("components.admin",[]).controller("adminCtrl",e("./adminCtrl.js"))},{"./adminCtrl.js":3}],5:[function(e,t,n){t.exports=angular.module("components.admin.users",[]).controller("usersCtrl",e("./usersCtrl.js"))},{"./usersCtrl.js":6}],6:[function(e,t,n){"use strict";t.exports=["$scope","$rootScope","$timeout","userSvc",function(e,t,n,r){function a(e,t,a){e.name?e.email?e.company?1!=a||e.password?1==a?r.addUser(e).then(function(e){e.data.success&&200==e.data.status_code&&(n(function(){dataGetService.success("User added successfully",1500)},200),angular.element("#addUserForm").modal("hide"),o())}):0==a&&(delete e.created_at,delete e.updated_at,delete e.user_type,delete e.status,delete e.survey_count,t?(e.password=t,delete e.newpassword):e.password="",userService.updateUser(e).then(function(e){n(function(){dataGetService.success("User updated successfully",1500)},200),angular.element("#editUserModal").modal("hide"),o()})):n(function(){dataGetService.errors("Please enter Password",1500)},500):n(function(){dataGetService.errors("Please enter Company",1500)},500):n(function(){dataGetService.errors("Please enter valid Email",1500)},500):n(function(){dataGetService.errors("Please enter Name",1500)},500)}t.loggedInPersonName=localStorage.getItem("loggedInPersonName"),e.textsearch="",e.dataEntered="",e.dataToEdit="",t.dataToEditNew="";var o=function(){r.getUserData().then(function(e){t.listdata=e.data})};e.addUser=function(){angular.element(".modal").on("hidden.bs.modal",function(){angular.element(this).find("input,textarea,select").val("").end()}),angular.element("#addForm").find("input,textarea,select").val("").end()},angular.element(document).keypress(function(e){"13"==e.which&&e.preventDefault()}),o(),e.addEmployees=function(e){void 0===e||null==e?n(function(){},500):a(e,null,!0)},e.closeForm=function(){angular.element("#addUserForm.modal").on("hidden.bs.modal",function(){angular.element(this).find("input,textarea,select").val("").end()}),angular.element("#addUserForm").modal("hide")},e.editData=function(e){r.getEditData(e.id).then(function(e){e.data.success&&(t.dataToEditNew=e.data.data)})},e.deleteUser=function(e){t.userTodelete=e.id},e.delete=function(e){r.deleteUser(e).then(function(e){return e.data.success&&(n(function(){dataGetService.success("User deleted successfully",1500)},200),angular.element("#myDeleteModal").modal("hide"),o()),e.data})},e.updateEmployees=function(e){void 0===e||null==e?n(function(){dataGetService.errors("Please enter data",5e3)},50):(delete e.password,a(e,e.newpassword,!1)),angular.element("#editUserModal").on("hidden.bs.modal",function(){angular.element(this).find("input,textarea,select").val("").end()})},e.filterFunction=function(t){if(t.name.match(new RegExp("("+e.textsearch+")","i"))||!!t.email.match(new RegExp("("+e.textsearch+")","i")))return t}}]},{}],7:[function(e,t,n){t.exports=angular.module("components",[e("./main").name,e("./user").name,e("./login").name,e("./admin").name,e("./admin/users").name])},{"./admin":4,"./admin/users":5,"./login":8,"./main":10,"./user":12}],8:[function(e,t,n){t.exports=angular.module("components.login",[]).controller("loginCtrl",e("./loginCtrl.js"))},{"./loginCtrl.js":9}],9:[function(e,t,n){"use strict";t.exports=["$scope","$auth","$rootScope","$state","authenticationSvc","appConstant",function(e,t,n,r,a,o){var s=function(){e.refreshData={grant_type:"refresh_token",refresh_token:localStorage.getItem("refresh_token"),client_id:o.client_id,client_secret:o.client_secret},e.access=a.refresh(e.refreshData).then(function(e){if(200==e.status_code&&e.success){localStorage.setItem("expiry_time",e.data.expires_in);var t=JSON.parse(localStorage.getItem("expiry_time"));localStorage.setItem("refresh_token",e.data.refresh_token),setInterval(function(){s()},1e3*t)}else e.success||"Unathenticated"!=e.message||r.log("main.login")})},i=function(e){localStorage.setItem("expiry_time",e.data.tokenDetails.expires_in),localStorage.setItem("refresh_token",e.data.tokenDetails.refresh_token);var a=JSON.parse(localStorage.getItem("expiry_time"));t.removeToken(),t.setToken(e.data.tokenDetails.token_type+" "+e.data.tokenDetails.access_token),setInterval(function(){s()},1e3*a),n.loggedInPersonName=e.data.userName,localStorage.setItem("loggedInPersonName",e.data.userName),"admin"==e.data.userType?r.go("admin.users"):"customer"==e.data.userType&&console.log("redirect to customer")},c=function(e){console.log(e),console.log(e.errors.message)};e.login=function(){e.data={username:e.username,password:e.password,grant_type:o.grant_type,client_id:o.client_id,client_secret:o.client_secret,refresh_token:null},e.access=a.login(e.data).then(i).catch(c)}}]},{}],10:[function(e,t,n){t.exports=angular.module("components.main",[]).controller("mainCtrl",e("./mainCtrl.js"))},{"./mainCtrl.js":11}],11:[function(e,t,n){"use strict";t.exports=["$scope",function(e){}]},{}],12:[function(e,t,n){t.exports=angular.module("components.user",[]).controller("userController",e("./user-controller")).config(e("./route.js"))},{"./route.js":13,"./user-controller":14}],13:[function(e,t,n){t.exports=["$stateProvider",function(e){e.state("main.user",{url:"/user",templateUrl:"./app/components/user/user.html",controller:"userController",controllerAs:"vm",ncyBreadcrumb:{label:"{{vm.mainPageTitle}}"}})}]},{}],14:[function(e,t,n){"use strict";t.exports=["$scope",function(e){console.log("change")}]},{}],15:[function(e,t,n){"use strict";angular.module("aliensSurveyApp",["ui.router","satellizer","ngAnimate","toaster","ngSanitize","naif.base64",e("./components").name,e("./shared").name]).config(e("./app.ui-router")).config(["$locationProvider",function(e){e.hashPrefix("")}]).run(e("./app.bootstrap"))},{"./app.bootstrap":1,"./app.ui-router":2,"./components":7,"./shared":17}],16:[function(e,t,n){"use strict";var r=angular.module("shared.appConstant",[]);r.constant("appConstant",{apiPath:"./api/",apiPathServer:"http://aliens.dev.easternenterprise.com/api/",grant_type:"password",client_id:2,client_secret:"zweSbThZRtujlkrqA5uogn3Zn30Htzl6y9IDT1YM"}),t.exports=r},{}],17:[function(e,t,n){t.exports=angular.module("shared",[e("./services/authInterceptor.js").name,e("./services/authenticationSvc.js").name,e("./services/userSvc.js").name,e("./constants/appConstant.js").name])},{"./constants/appConstant.js":16,"./services/authInterceptor.js":18,"./services/authenticationSvc.js":19,"./services/userSvc.js":20}],18:[function(e,t,n){"use stict";var r=angular.module("shared.authInterceptor",[]);r.factory("authInterceptor",["$rootScope","$q",function(e,t){return{responseError:function(n){return 401===n.status?(e.$broadcast("auth.request.error"),t.reject(n)):t.reject(n)}}}]),t.exports=r},{}],19:[function(e,t,n){"use strict";var r=angular.module("shared.auth",[]);r.factory("authenticationSvc",["$http","$q","$rootScope","appConstant",function(e,t,n,r){return{login:function(n){var a=r.apiPathServer+"login",o=t.defer();return e.post(a,n).then(function(e){o.resolve(e.data)},function(e){o.reject(e.data)}),o.promise},refresh:function(n){var a=r.apiPathServer+"refreshToken",o=t.defer();return e.post(a,n).then(function(e){o.resolve(e.data)},function(e){o.reject(e.data)}),o.promise},logout:function(){var n=r.apiPathServer+"logout",a=t.defer();return e.post(n).then(function(e){a.resolve(e.data)},function(e){a.reject(e.data)}),a.promise}}}]),t.exports=r},{}],20:[function(e,t,n){"use strict";var r=angular.module("shared.userSvc",[]);r.factory("userSvc",["$http","$q","$rootScope","appConstant",function(e,t,n,r){return{getUserData:function(){var n=r.apiPathServer+"users/List",a=t.defer();return e.get(n).then(function(e){a.resolve(e.data)},function(e){a.reject(e.data)}),a.promise},addUser:function(n){var a=r.apiPathServer+"users/create",o=t.defer();return e.post(a,n).then(function(e){o.resolve(e)},function(e){o.reject(e)}),o.promise},updateUser:function(n){var a=r.apiPathServer+"users/update",o=t.defer();return e.put(a,n).then(function(e){o.resolve(e)},function(e){o.reject(e)}),o.promise},deleteUser:function(n){var a=r.apiPathServer+"users/delete?id="+n,o=t.defer();return e.delete(a).then(function(e){o.resolve(e)},function(e){o.reject(e)}),o.promise},getEditData:function(n){var a=r.apiPathServer+"users/edit?user_id="+n,o=t.defer();return e.get(a).then(function(e){o.resolve(e)},function(e){o.reject(e)}),o.promise}}}]),t.exports=r},{}]},{},[15]);
//# sourceMappingURL=app.js.map
